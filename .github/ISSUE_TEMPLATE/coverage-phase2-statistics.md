---
name: "Phase 2: é‡è¦ãƒ­ã‚¸ãƒƒã‚¯ - çµ±è¨ˆè§£æå¼·åŒ–"
about: 2é€±é–“ã§50% â†’ 55%åˆ°é” (+5%)
title: "[P1-test] Phase 2: é‡è¦ãƒ­ã‚¸ãƒƒã‚¯ - çµ±è¨ˆè§£æå¼·åŒ–"
labels: ["P1", "test", "coverage", "phase2", "statistics"]
assignees: []
---

## ğŸ¯ ç›®æ¨™

**ã‚«ãƒãƒ¬ãƒƒã‚¸**: 50% â†’ **55%** (+5%)
**æœŸé–“**: 2025-11-11 ~ 2025-11-24 (2é€±é–“)
**å·¥æ•°**: 16æ™‚é–“
**å‰ææ¡ä»¶**: âš ï¸ **çµ±è¨ˆå­¦çŸ¥è­˜å¿…é ˆ** (zæ¤œå®šã€ãƒ™ã‚¤ã‚ºçµ±è¨ˆ)

---

## ğŸ“‹ ã‚¿ã‚¹ã‚¯ä¸€è¦§

### ğŸ”² Task 1: statisticalSignificance.test.ts (Week 1)

- **ç¾çŠ¶**: 9.11% (748è¡Œ)
- **ç›®æ¨™**: 70%
- **åŠ¹æœ**: +2%
- **å·¥æ•°**: 8æ™‚é–“
- **å„ªå…ˆåº¦**: P1
- **ãƒªã‚¹ã‚¯**: ğŸ”´ **é«˜** (çµ±è¨ˆé–¢æ•°ã®æ­£ç¢ºæ€§ãŒå¿…é ˆ)

#### å®Ÿè£…è¦ä»¶

**ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹** (æ¨å®š40-50ã‚±ãƒ¼ã‚¹):

1. **æ¨™æº–æ­£è¦åˆ†å¸ƒé–¢æ•°** (10ã‚±ãƒ¼ã‚¹)

   ```typescript
   describe("normalCDF", () => {
     it("z=0 ã§ 0.5 ã‚’è¿”ã™", () => {
       expect(normalCDF(0)).toBeCloseTo(0.5, 4);
     });

     it("z=1.96 ã§ç´„0.975ã‚’è¿”ã™ (95%ä¿¡é ¼åŒºé–“)", () => {
       expect(normalCDF(1.96)).toBeCloseTo(0.975, 3);
     });

     it("z=-1.96 ã§ç´„0.025ã‚’è¿”ã™", () => {
       expect(normalCDF(-1.96)).toBeCloseTo(0.025, 3);
     });
   });
   ```

2. **z-scoreè¨ˆç®—** (10ã‚±ãƒ¼ã‚¹)
   - 2ç¾¤ã®å¤‰æ›ç‡æ¯”è¼ƒ
   - ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚ºã®å½±éŸ¿æ¤œè¨¼
   - ã‚¼ãƒ­é™¤ç®—ã‚¨ãƒƒã‚¸ã‚±ãƒ¼ã‚¹
   - NaN/Infinity ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

3. **p-valueè¨ˆç®—** (10ã‚±ãƒ¼ã‚¹)
   - ä¸¡å´æ¤œå®š
   - ç‰‡å´æ¤œå®š
   - æœ‰æ„æ°´æº–å¢ƒç•Œå€¤ (Î±=0.05, 0.01)

4. **ãƒ™ã‚¤ã‚ºãƒ•ã‚¡ã‚¯ã‚¿ãƒ¼** (10ã‚±ãƒ¼ã‚¹)
   - äº‹å‰åˆ†å¸ƒãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®å½±éŸ¿
   - äº‹å¾Œç¢ºç‡è¨ˆç®—
   - ä¿¡ç”¨åŒºé–“ (Credible Interval)
   - è§£é‡ˆã‚«ãƒ†ã‚´ãƒª (decisive/strong/moderate/weak)

5. **åŠ¹æœã‚µã‚¤ã‚º (Cohen's d)** (5ã‚±ãƒ¼ã‚¹)
   - å°/ä¸­/å¤§ã®åŠ¹æœã‚µã‚¤ã‚ºåˆ¤å®š
   - ãƒ—ãƒ¼ãƒ«ã•ã‚ŒãŸæ¨™æº–åå·®è¨ˆç®—

**ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ä¾‹**:

```typescript
const controlGroup = {
  sampleSize: 1000,
  successes: 100, // 10% conversion
  mean: 0.1,
  standardDeviation: 0.3,
};

const variantGroup = {
  sampleSize: 1000,
  successes: 130, // 13% conversion
  mean: 0.13,
  standardDeviation: 0.33,
};

// æœŸå¾…å€¤: z â‰ˆ 2.16, p < 0.05 (æœ‰æ„å·®ã‚ã‚Š)
```

**å‚è€ƒãƒ©ã‚¤ãƒ–ãƒ©ãƒª (æ¤œè¨¼ç”¨)**:

- `jstat` (JavaScriptçµ±è¨ˆãƒ©ã‚¤ãƒ–ãƒ©ãƒª)
- `simple-statistics`
- æ—¢çŸ¥ã®çµ±è¨ˆãƒ†ãƒ¼ãƒ–ãƒ«å€¤ã¨ã®æ¯”è¼ƒ

---

### ğŸ”² Task 2: abTestResultsAnalyzer.test.ts (Week 2)

- **ç¾çŠ¶**: 3.04% (308è¡Œ)
- **ç›®æ¨™**: 60%
- **åŠ¹æœ**: +1%
- **å·¥æ•°**: 8æ™‚é–“
- **å„ªå…ˆåº¦**: P1
- **ä¾å­˜**: Task 1 (statisticalSignificance.ts ã®ãƒ¢ãƒƒã‚¯å¿…é ˆ)

#### å®Ÿè£…è¦ä»¶

**ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹** (æ¨å®š25-30ã‚±ãƒ¼ã‚¹):

1. **ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿åˆ†é›¢** (5ã‚±ãƒ¼ã‚¹)

   ```typescript
   describe("simulate20PercentResults", () => {
     it("æ­£ã—ã„ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã‚’è¿”ã™", () => {
       const result = simulate20PercentResults();
       expect(result).toHaveProperty("currentPhase");
       expect(result).toHaveProperty("statisticalSignificance");
       expect(result).toHaveProperty("performanceComparison");
     });
   });
   ```

2. **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ¯”è¼ƒè¨ˆç®—** (8ã‚±ãƒ¼ã‚¹)
   - renderTimeæ”¹å–„ç‡è¨ˆç®—
   - memoryUsageæ”¹å–„ç‡è¨ˆç®—
   - errorRateæ”¹å–„ç‡è¨ˆç®—
   - è² ã®æ”¹å–„ç‡ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚° (æ‚ªåŒ–)

3. **ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆåˆ†æ** (8ã‚±ãƒ¼ã‚¹)
   - CTR (ã‚¯ãƒªãƒƒã‚¯ã‚¹ãƒ«ãƒ¼ç‡) æ”¹å–„è¨ˆç®—
   - ã‚»ãƒƒã‚·ãƒ§ãƒ³æ™‚é–“æ”¹å–„è¨ˆç®—
   - ãƒã‚¦ãƒ³ã‚¹ç‡æ”¹å–„è¨ˆç®— (è² ã®å€¤ãŒè‰¯ã„)

4. **æ¨å¥¨äº‹é …ç”Ÿæˆ** (8ã‚±ãƒ¼ã‚¹)

   ```typescript
   describe("ãƒ­ãƒ¼ãƒ«ã‚¢ã‚¦ãƒˆæ¨å¥¨", () => {
     it("æœ‰æ„å·®ã‚ã‚Šã®å ´åˆã¯ proceed_to_50 ã‚’æ¨å¥¨", () => {
       const result = analyzeABTest({
         pValue: 0.01, // æœ‰æ„
         improvement: 15, // 15%æ”¹å–„
       });
       expect(result.recommendation.action).toBe("proceed_to_50");
       expect(result.recommendation.confidence).toBe("high");
     });

     it("æœ‰æ„å·®ãªã—ã®å ´åˆã¯ continue_20 ã‚’æ¨å¥¨", () => {
       const result = analyzeABTest({
         pValue: 0.3, // éæœ‰æ„
         improvement: 2, // 2%æ”¹å–„
       });
       expect(result.recommendation.action).toBe("continue_20");
     });
   });
   ```

5. **ãƒªã‚¹ã‚¯è©•ä¾¡** (5ã‚±ãƒ¼ã‚¹)
   - æ¨å®šã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³è¨ˆç®—
   - ãƒªã‚¹ã‚¯é …ç›®ç”Ÿæˆ
   - ç·©å’Œç­–ææ¡ˆ

---

## âš ï¸ ãƒªã‚¹ã‚¯è©•ä¾¡

| ãƒªã‚¹ã‚¯             | å½±éŸ¿åº¦ | å¯¾ç­–                                 |
| ------------------ | ------ | ------------------------------------ |
| **çµ±è¨ˆçŸ¥è­˜ä¸è¶³**   | ğŸ”´ é«˜  | çµ±è¨ˆå°‚é–€å®¶ãƒ¬ãƒ“ãƒ¥ãƒ¼å¿…é ˆ               |
| **å°æ•°ç‚¹ç²¾åº¦å•é¡Œ** | ğŸŸ¡ ä¸­  | `toBeCloseTo(value, precision)` ä½¿ç”¨ |
| **å‚è€ƒãƒ‡ãƒ¼ã‚¿ä¸è¶³** | ğŸŸ¡ ä¸­  | æ—¢çŸ¥ã®çµ±è¨ˆãƒ†ãƒ¼ãƒ–ãƒ«å€¤ã¨æ¯”è¼ƒ           |
| **ãƒ†ã‚¹ãƒˆå®Ÿè¡Œæ™‚é–“** | ğŸŸ¢ ä½  | ãƒ¢ãƒƒã‚¯æ´»ç”¨ã€è¨ˆç®—é‡å‰Šæ¸›               |

---

## âœ… å®Œäº†æ¡ä»¶

- [ ] å…¨ãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆãŒé€šé (åˆè¨ˆ 65-80ãƒ†ã‚¹ãƒˆè¿½åŠ )
- [ ] ã‚«ãƒãƒ¬ãƒƒã‚¸ãŒ **55%ä»¥ä¸Š** ã«åˆ°é”
- [ ] çµ±è¨ˆé–¢æ•°ã®æ•°å­¦çš„æ­£ç¢ºæ€§ãŒæ¤œè¨¼æ¸ˆã¿
- [ ] å°‚é–€å®¶ãƒ¬ãƒ“ãƒ¥ãƒ¼å®Œäº† (çµ±è¨ˆå­¦çš„å¦¥å½“æ€§)
- [ ] ESLint/TypeScript ã‚¨ãƒ©ãƒ¼ 0ä»¶
- [ ] Quality Gateså…¨é€šé

---

## ğŸ“Š ã‚«ãƒãƒ¬ãƒƒã‚¸å½±éŸ¿äºˆæ¸¬

| ã‚¿ã‚¹ã‚¯                     | ç¾çŠ¶  | ç›®æ¨™ | ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå½±éŸ¿ |
| -------------------------- | ----- | ---- | ---------------- |
| statisticalSignificance.ts | 9.11% | 70%  | +2%              |
| abTestResultsAnalyzer.ts   | 3.04% | 60%  | +1%              |
| **åˆè¨ˆ**                   | -     | -    | **+3%**          |

**æœ€çµ‚ã‚«ãƒãƒ¬ãƒƒã‚¸**: 50% + 3% = **53%** â†’ Phase 3ã§55%åˆ°é”

---

## ğŸš€ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

Phase 2å®Œäº†å¾Œã€Phase 3 (ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–UI) ã«ç§»è¡Œ:

- CuisineFilter/DistrictFilter/FeatureFilter ãƒ†ã‚¹ãƒˆ
- CustomMapControls + FilterModal ãƒ†ã‚¹ãƒˆ
- ã‚«ãƒãƒ¬ãƒƒã‚¸ 65% åˆ°é”

---

## ğŸ“ é–¢é€£ãƒªãƒ³ã‚¯

- [statisticalSignificance.ts ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰](../../../src/services/abtest/statisticalSignificance.ts)
- [abTestResultsAnalyzer.ts ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰](../../../src/services/abtest/abTestResultsAnalyzer.ts)
- [TASKS.md](../../../docs/tasks/TASKS.md)
- [Wikipedia: zæ¤œå®š](https://ja.wikipedia.org/wiki/Z%E6%A4%9C%E5%AE%9A)
- [Wikipedia: ãƒ™ã‚¤ã‚ºãƒ•ã‚¡ã‚¯ã‚¿ãƒ¼](https://ja.wikipedia.org/wiki/%E3%83%99%E3%82%A4%E3%82%BA%E5%9B%A0%E5%AD%90)
