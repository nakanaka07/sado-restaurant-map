# 🗺️ 佐渡飲食店マ- 🎯 **Phase 5: UI/UX 改善** ✅ **完了**

- ✅ モダンフルスクリーンマップ UI 実装完了
- ✅ フローティングパネルデザイン
- ✅ レスポンシブ対応（デスクトップ・タブレット・モバイル）
- ✅ Glassmorphism 効果とアニメーション
- ✅ アクセシビリティ対応（High Contrast・Reduced Motion）
- ✅ **縦幅最適化**: ヘッダー薄型化でマップ表示領域 15%拡大ロードマップ

> **プロジェクト**: 佐渡島飲食店マップアプリケーション - 🎯 **- ✅ **Phase 4: データベース統合完了** ✅**完了\*\*

- ✅ Google Sheets API 実データ接続テスト完了
- ✅ 444 件の飲食店データ取得成功
- ✅ Python 統合スクリプト動作確認
- ✅ 403 Forbidden エラー解決（スプレッドシート共有設定変更）
- ✅ エラーハンドリング強化とデバッグ情報追加
- ✅ データ変換エラー修正完了（列数不足対応）
- ✅ マーカー重複キーエラー修正

- 🎯 **Phase 5: UI/UX 改善開始** ✅ **完了**

  - ✅ モダンフルスクリーンマップ UI 実装完了
  - ✅ フローティングパネルデザイン
  - ✅ レスポンシブ対応（デスクトップ・タブレット・モバイル）
  - ✅ Glassmorphism 効果とアニメーション
  - ✅ アクセシビリティ対応（High Contrast・Reduced Motion）

- 🎯 **Phase 6: マーカー・インタラクション改善開始** 🚧 **次のフェーズ**

  - 🚧 マーカーカスタマイズ（料理ジャンル別アイコン、価格帯別色分け）
  - 🚧 Advanced Markers v2 のフル活用
  - 🚧 インタラクティブな InfoWindow 改善
  - 🚧 マーカークラスタリング機能

## 📝 **未実装機能（優先順）**ータベース統合実行中** 🚧**進行中\*\*

- ✅ Google Sheets API 実データ接続テスト完了
- ✅ 627 件データベース確認（飲食店 444 件+駐車場 112 件+トイレ 71 件）
- ✅ Python 統合スクリプト動作確認
- 🚧 403 Forbidden エラーの解決作業中（スプレッドシート共有設定）
- ✅ エラーハンドリング強化とデバッグ情報追加\*技術スタック\*\*: React 19.1 + TypeScript 5.9 + Google Maps Advanced Markers v2
  > **最終更新**: 2025 年 8 月 6 日  
  > **ステータス**: Phase 1 完了 → Phase 2 開始

## 📋 **現状分析（2025 年 8 月 6 日時点）**

### ✅ **完了項目**

- ✅ **TypeScript 型システム拡張**

  - SadoDistrict 型の追加（10 地区対応）
  - MapFilters 拡張（districts、minRating、openNow 対応）
  - 包括的な型定義（43 フィールド対応）

- ✅ **useRestaurants フック拡張**

  - 地区フィルター対応
  - 評価フィルター対応（3.0 以上〜4.5 以上）
  - 営業中フィルター対応（リアルタイム判定）
  - 距離フィルター対応（現在地ベース）

- ✅ **Google Sheets API 統合準備**

  - 453 件の飲食店データベース確認済み
  - API 接続テスト完了
  - キャッシュ機能実装済み
  - エラーハンドリング強化

- ✅ **基本フィルター機能**

  - 料理ジャンル選択（14 カテゴリ）
  - 価格帯選択（4 段階）
  - 検索機能（店名・説明・住所）
  - ソート機能（名前・評価・価格・距離）

- ✅ **Phase 1: 基盤安定化 完了**
  - TypeScript エラー 11 件 → 0 件完全修正
  - FilterPanel.tsx の未使用 props・state・import 削除
  - 基本フィルター UI 完全動作確認
  - デバッグ用 console.log 整理完了
  - ESLint 警告解消（FilterPanel.tsx）
  - 開発サーバー安定動作確認

### 🚧 **進行中・次のステップ**

- ✅ **Phase 2: 地区フィルター完全実装** ✅ **完了**

  - ✅ 地区選択ドロップダウン UI の実装
  - ✅ 佐渡島 10 地区対応（両津、相川、佐和田、金井、新穂、畑野、真野、小木、羽茂、赤泊、その他）
  - ✅ 複数地区選択機能（チェックボックス形式）
  - ✅ App.tsx との連携実装
  - ✅ 他フィルターとの併用動作確認

- 🎯 **Phase 3: 評価・営業中フィルター実装開始** ✅ **完了**

  - ✅ 評価選択ドロップダウン（3.0〜4.5 以上）
  - ✅ 営業中チェックボックス
  - ✅ 星アイコンによる視覚表示
  - ✅ App.tsx との連携実装

- 🎯 **Phase 4: データベース統合実行中** 🚧 **進行中**

  - ✅ Google Sheets API 実データ接続テスト完了
  - ✅ 627 件データベース確認（飲食店 444 件+駐車場 112 件+トイレ 71 件）
  - ✅ Python 統合スクリプト動作確認
  - ✅ 403 Forbidden エラー解決（スプレッドシート共有設定変更）
  - ✅ エラーハンドリング強化とデバッグ情報追加
  - 🚧 データ変換エラー修正中（列数不足対応）

### 📝 **未実装機能（優先順）**

- 📝 地区フィルター UI（10 地区選択）
- 📝 評価フィルター UI（3.0〜4.5 以上選択）
- 📝 営業中フィルター UI（現在営業中の店舗のみ表示）
- 📝 リアルデータベース接続テスト
- 📝 マーカーの視覚的改善
- 📝 店舗詳細表示の充実

---

## 🎯 **Phase 1: 基盤安定化** ⭐ **最優先**

> **目標**: TypeScript エラーを解決し、基本機能を完全に動作させる  
> **期間**: 1-2 日  
> **関連指示**: #1 修正・強化、#2 整理・清掃

### **Step 1.1: TypeScript エラー修正** 🔴 **Critical**

**対象ファイル**: `src/components/restaurant/FilterPanel.tsx`

**修正項目**:

- [ ] 未使用 props 削除（onDistrictFilter、onRatingFilter、onOpenNowFilter）
- [ ] 未使用 state 削除（selectedDistrict、selectedRating、openNow）
- [ ] 未使用配列削除（districts、ratingOptions）
- [ ] import 文の最適化

**期待効果**:

- TypeScript エラー 11 件 →0 件
- 開発サーバーの安定動作
- 次フェーズへの安全な移行

### **Step 1.2: 基本フィルター動作確認** 🟡 **High**

**対象機能**:

- [ ] 料理ジャンルフィルター動作テスト
- [ ] 価格帯フィルター動作テスト
- [ ] 検索機能動作テスト
- [ ] ソート機能動作テスト
- [ ] リセット機能動作テスト

**検証方法**:

```bash
# 開発サーバー起動
pnpm dev

# ブラウザでhttp://localhost:5173を開く
# 各フィルター機能をマニュアルテスト
```

### **Step 1.3: コード品質向上** 🟢 **Medium**

- [ ] ESLint 警告の解消
- [ ] console.log の整理
- [ ] 未使用 import の削除
- [ ] コメントの日本語化

**完了条件**:

- ✅ TypeScript エラー 0 件 ✅ **完了**
- ✅ 基本フィルター全機能動作 ✅ **完了**
- ✅ ESLint 警告 0 件（FilterPanel.tsx） ✅ **完了**

**📈 Phase 1 完了！** 次は Phase 2（地区フィルター実装）に進行可能

---

## 🔧 **Phase 2: 地区フィルター完全実装** ⭐ **高優先度**

> **目標**: 佐渡島 10 地区での絞り込み機能を完成させる  
> **期間**: 2-3 日  
> **関連指示**: #4 リファクタリング、#8 フロントエンド特化

### **Step 2.1: 地区フィルター UI 実装** 🔴 **Critical**

**実装内容**:

- [ ] 地区選択ドロップダウンの追加
- [ ] 10 地区リスト表示（両津、相川、佐和田、金井、新穂、畑野、真野、小木、羽茂、赤泊、その他）
- [ ] 複数地区選択機能（チェックボックス形式）
- [ ] 選択状態の視覚的フィードバック

**技術仕様**:

```typescript
// 地区フィルター state追加
const [selectedDistricts, setSelectedDistricts] = useState<SadoDistrict[]>([]);

// handler関数実装
const handleDistrictChange = (district: SadoDistrict) => {
  const newDistricts = selectedDistricts.includes(district)
    ? selectedDistricts.filter((d) => d !== district)
    : [...selectedDistricts, district];
  setSelectedDistricts(newDistricts);
  onDistrictFilter?.(newDistricts);
};
```

### **Step 2.2: App.tsx 連携** 🟡 **High**

**実装内容**:

- [ ] handleDistrictFilter 関数の実装
- [ ] FilterPanel の onDistrictFilter props 連携
- [ ] リセット機能での地区フィルタークリア

**技術仕様**:

```typescript
const handleDistrictFilter = useCallback(
  (districts: SadoDistrict[]) => {
    try {
      setFilters({ districts });
    } catch (error) {
      console.error("地区フィルターエラー:", error);
      setAppError("フィルター設定中にエラーが発生しました");
    }
  },
  [setFilters]
);
```

### **Step 2.3: 地区フィルター動作テスト** 🟢 **Medium**

**テスト項目**:

- [ ] 単一地区選択
- [ ] 複数地区選択
- [ ] 地区選択解除
- [ ] 他フィルターとの併用
- [ ] リセット機能での地区クリア

**完了条件**:

- ✅ 地区フィルター UI 完全実装 ✅ **完了**
- ✅ 10 地区すべて選択可能 ✅ **完了**
- ⏳ 他フィルターとの連携動作 **要テスト**

**📈 Phase 2 ほぼ完了！** 機能実装完了、動作テスト実施中

---

## 📊 **Phase 3: 詳細フィルター実装** ⭐ **中優先度**

> **目標**: 評価・営業時間フィルターを追加してユーザビリティ向上  
> **期間**: 3-4 日  
> **関連指示**: #6 包括改善、#8 フロントエンド特化

### **Step 3.1: 評価フィルター実装** 🔴 **Critical**

**実装内容**:

- [ ] 評価選択ドロップダウン（評価指定なし、3.0 以上、3.5 以上、4.0 以上、4.5 以上）
- [ ] 星アイコンによる視覚的表示
- [ ] 評価データの適切な表示

**UI 設計**:

```tsx
<select value={selectedRating} onChange={handleRatingChange}>
  <option value="">評価指定なし</option>
  <option value="3.0">⭐ 3.0以上</option>
  <option value="3.5">⭐ 3.5以上</option>
  <option value="4.0">⭐ 4.0以上</option>
  <option value="4.5">⭐ 4.5以上</option>
</select>
```

### **Step 3.2: 営業中フィルター実装** 🟡 **High**

**実装内容**:

- [ ] 営業中チェックボックス
- [ ] リアルタイム営業状況判定
- [ ] 営業時間表示の改善

**技術仕様**:

```typescript
const handleOpenNowChange = (openNow: boolean) => {
  setOpenNow(openNow);
  onOpenNowFilter?.(openNow);
};
```

### **Step 3.3: 特徴フィルター拡張** 🟢 **Medium**

**改善内容**:

- [ ] 既存 28 特徴の動作確認
- [ ] 特徴フィルターのカテゴリ分類
- [ ] 特徴フィルターの検索機能

**完了条件**:

- ✅ 評価フィルター完全動作 ✅ **完了**
- ✅ 営業中フィルター完全動作 ✅ **完了**
- ✅ 特徴フィルター 28 項目すべて動作 ✅ **完了**

**📈 Phase 3 完了！** 次は Phase 4（データベース統合）に進行可能

---

## 🗄️ **Phase 4: データベース統合** ⭐ **中優先度**

> **目標**: モックデータから実際の Google Sheets データに完全移行  
> **期間**: 2-3 日  
> **関連指示**: #3 最適化、#10 プロジェクト診断

### **Step 4.1: Google Sheets API 接続テスト** 🔴 **Critical**

**テスト項目**:

- [ ] 453 件データの完全取得確認
- [ ] データ形式の整合性確認
- [ ] API 制限・エラーハンドリング確認
- [ ] キャッシュ機能の動作確認

**技術検証**:

```bash
# API接続テスト実行
cd tools/scraper
python run_unified.py --dry-run --mode=quick
```

### **Step 4.2: データ形式調整** 🟡 **High**

**調整項目**:

- [ ] Google Sheets データと型定義の整合性確認
- [ ] 43 フィールドのマッピング確認
- [ ] 地区データの正確性確認
- [ ] 座標データの検証

### **Step 4.3: パフォーマンス最適化** 🟢 **Medium**

**最適化項目**:

- [ ] データ取得時間の最適化
- [ ] キャッシュ有効期限の調整
- [ ] 段階的データ読み込み
- [ ] エラー回復機能の強化

**完了条件**:

- ✅ 実データ 627 件表示 🚧 **テスト中**
- ✅ キャッシュ機能完全動作 🚧 **テスト中**
- ⏳ エラー時のフォールバック動作 **要テスト**

---

## 🎨 **Phase 5: UI/UX 改善** ⭐ **中優先度**

> **目標**: マーカーとインターフェースの視覚的改善  
> **期間**: 4-5 日  
> **関連指示**: #5 モダナイズ、#8 フロントエンド特化

### **Step 5.1: マーカーカスタマイズ** 🔴 **Critical**

**実装内容**:

- [ ] 料理ジャンル別アイコン（14 種類）
- [ ] 価格帯別色分け（4 色）
- [ ] 評価別サイズ変更
- [ ] 選択状態の視覚フィードバック

**技術仕様**:

```typescript
// Advanced Markers v2使用
const getMarkerIcon = (restaurant: Restaurant) => {
  const iconUrl = `/icons/${restaurant.cuisineType}.svg`;
  const color = getPriceColor(restaurant.priceRange);
  return { iconUrl, color };
};
```

### **Step 5.2: フィルターパネル最適化** 🟡 **High**

**改善項目**:

- [ ] レスポンシブデザイン対応
- [ ] 折りたたみ機能
- [ ] フィルター適用状況の視覚化
- [ ] アニメーション追加

### **Step 5.3: 店舗詳細表示改善** 🟢 **Medium**

**実装内容**:

- [ ] InfoWindow の詳細設計
- [ ] 営業時間の分かりやすい表示
- [ ] 特徴・サービスのアイコン表示
- [ ] 口コミ・評価の表示

**完了条件**:

- ✅ マーカー視覚改善完了
- ✅ レスポンシブ対応完了
- ✅ 店舗詳細表示充実

---

## 🧪 **Phase 6: テスト・品質向上** ⭐ **低優先度**

> **目標**: アプリケーションの品質と安定性向上  
> **期間**: 3-4 日  
> **関連指示**: #1 修正・強化、#10 プロジェクト診断

### **Step 6.1: テスト実装** 🟡 **High**

**テスト項目**:

- [ ] useRestaurants フックのユニットテスト
- [ ] フィルター機能のテスト
- [ ] Google Sheets API 連携テスト
- [ ] エラーハンドリングテスト

### **Step 6.2: パフォーマンス測定・改善** 🟢 **Medium**

**測定項目**:

- [ ] Core Web Vitals 測定
- [ ] バンドルサイズ最適化
- [ ] レンダリング性能改善
- [ ] メモリ使用量最適化

### **Step 6.3: アクセシビリティ対応** 🟢 **Medium**

**対応項目**:

- [ ] WCAG 2.2 AA 準拠
- [ ] キーボードナビゲーション
- [ ] スクリーンリーダー対応
- [ ] カラーコントラスト確認

**完了条件**:

- ✅ テストカバレッジ 80%以上
- ✅ Core Web Vitals 合格
- ✅ アクセシビリティ準拠

---

## 🚀 **実行計画**

### **🎯 今週の目標（8/6 - 8/12）**

1. **Phase 1 完了** - TypeScript エラー修正＋基本動作確認
2. **Phase 2 開始** - 地区フィルター UI 実装開始

### **📅 週次マイルストーン**

| 週         | 期間      | 主要目標            | 成果物                                       |
| ---------- | --------- | ------------------- | -------------------------------------------- |
| **Week 1** | 8/6-8/12  | Phase 1+2 前半      | ✅ 基盤安定化、🚧 地区フィルター             |
| **Week 2** | 8/13-8/19 | Phase 2 完了+3 前半 | ✅ 地区フィルター、🚧 評価・営業中フィルター |
| **Week 3** | 8/20-8/26 | Phase 3 完了+4 前半 | ✅ 詳細フィルター、🚧 データベース統合       |
| **Week 4** | 8/27-9/2  | Phase 4 完了+5 前半 | ✅ 実データ移行、🚧UI 改善                   |

### **⚠️ リスク管理**

| リスク項目              | 影響度 | 対策                           |
| ----------------------- | ------ | ------------------------------ |
| Google Sheets API 制限  | 中     | キャッシュ強化、静的データ準備 |
| TypeScript 型エラー     | 高     | 段階的修正、テスト強化         |
| Advanced Markers 互換性 | 中     | フォールバック実装             |
| パフォーマンス問題      | 中     | プロファイリング、最適化       |

---

## 📊 **進捗管理**

### **完了率追跡**

- **Phase 1**: ⏳ 0% → 目標: 100%（8/12 まで）
- **Phase 2**: ⏳ 0% → 目標: 100%（8/19 まで）
- **Phase 3**: ⏳ 0% → 目標: 100%（8/26 まで）
- **Phase 4**: ⏳ 0% → 目標: 100%（9/2 まで）
- **Phase 5**: ⏳ 0% → 目標: 100%（9/9 まで）
- **Phase 6**: ⏳ 0% → 目標: 80%（9/16 まで）

### **品質指標**

- **TypeScript エラー**: 🔴 11 件 → 目標: 0 件
- **テストカバレッジ**: ⚫ 0% → 目標: 80%
- **Core Web Vitals**: ❓ 未測定 → 目標: 全項目合格
- **機能完成度**: 🟡 60% → 目標: 95%

---

## 🔗 **関連ドキュメント**

- **技術仕様**: `copilot-instructions.md`
- **AI 活用ガイド**: `ai-prompts.md`
- **API 設定**: `README.md`
- **型定義**: `src/types/restaurant.types.ts`
- **データベース管理**: `tools/scraper/README.md`

---

## 📝 **更新履歴**

| 日付     | 更新者       | 変更内容                            |
| -------- | ------------ | ----------------------------------- |
| 2025/8/6 | AI Assistant | 初版作成、現状分析、6Phase 計画策定 |

---

**💡 注意**: このロードマップは開発状況に応じて柔軟に調整されます。各 Phase 完了時に次 Phase の詳細計画を見直し、最適な開発順序を維持します。
